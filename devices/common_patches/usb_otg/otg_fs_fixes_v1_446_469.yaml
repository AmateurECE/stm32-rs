# For F446, F469, F479

OTG_FS_GLOBAL:
  GOTGCTL:
    _add:
      VBVALOEN:
        description: VBUS valid override enable
        bitOffset: 2
        bitWidth: 1
        access: read-write
      VBVALOVAL:
        description: VBUS valid override value
        bitOffset: 3
        bitWidth: 1
        access: read-write
      AVALOEN:
        description: A-peripheral session valid override enable
        bitOffset: 4
        bitWidth: 1
        access: read-write
      AVALOVAL:
        description: A-peripheral session valid override value
        bitOffset: 5
        bitWidth: 1
        access: read-write
      BVALOEN:
        description: B-peripheral session valid override enable
        bitOffset: 6
        bitWidth: 1
        access: read-write
      BVALOVAL:
        description: B-peripheral session valid override value
        bitOffset: 7
        bitWidth: 1
        access: read-write
      EHEN:
        description: Embedded host enable
        bitOffset: 12
        bitWidth: 1
        access: read-write
      OTGVER:
        description: OTG version
        bitOffset: 20
        bitWidth: 1
        access: read-write
      CURMOD:
        description: Current mode of operation
        bitOffset: 21
        bitWidth: 1
        access: read-only
  GOTGINT:
    _add:
      IDCHNG:
        description: ID input pin changed
        bitOffset: 20
        bitWidth: 1
  GUSBCFG:
    _delete:
      - CTXPKT
  GINTSTS:
    _add:
      RSTDET:
        description: Reset detected interrupt
        bitOffset: 23
        bitWidth: 1
        access: read-write
  GINTMSK:
    _delete:
      - EPMISM
    _add:
      RSTDETM:
        description: Reset detected interrupt mask
        bitOffset: 23
        bitWidth: 1
        access: read-write
      LPMIN:
        description: LPM interrupt mask
        bitOffset: 27
        bitWidth: 1
        access: read-write
    _modify:
      PRTIM:
        access: read-write
  GCCFG:
    _delete:
      - VBUSASEN
      - VBUSBSEN
      - SOFOUTEN
    _add:
      VBDEN:
        description: USB VBUS detection enable
        bitOffset: 21
        bitWidth: 1
  _copy:
    DIEPTXF4:
      _from: DIEPTXF1
      addressOffset: 0x110
    DIEPTXF5:
      _from: DIEPTXF1
      addressOffset: 0x114

  GRXSTSR_Host:
    _delete:
      - FRMNUM
    _modify:
      EPNUM:
        name: CHNUM
        description: Channel number
  _add:
    GRXSTSP_Device:
      description: OTG status read and pop (device mode)
      addressOffset: 0x20
      size: 32
      resetValue: 0x00000000
      access: read-only
      fields:
        STSPHST:
          description: Status phase start
          bitOffset: 27
          bitWidth: 1
        FRMNUM:
          description: Frame number
          bitOffset: 21
          bitWidth: 4
        PKTSTS:
          description: Packet status
          bitOffset: 17
          bitWidth: 4
        DPID:
          description: Data PID
          bitOffset: 15
          bitWidth: 2
        BCNT:
          description: Byte count
          bitOffset: 4
          bitWidth: 11
        EPNUM:
          description: Endpoint number
          bitOffset: 0
          bitWidth: 4
    GRXSTSP_Host:
      description: OTG status read and pop (host mode)
      addressOffset: 0x20
      size: 32
      resetValue: 0x00000000
      access: read-only
      alternateRegister: GRXSTSP_Device
      fields:
        PKTSTS:
          description: Packet status
          bitOffset: 17
          bitWidth: 4
        DPID:
          description: Data PID
          bitOffset: 15
          bitWidth: 2
        BCNT:
          description: Byte count
          bitOffset: 4
          bitWidth: 11
        CHNUM:
          description: Channel number
          bitOffset: 0
          bitWidth: 4

    GLPMCFG:
      addressOffset: 0x54
      size: 32
      resetValue: 0x0
      fields:
        LPMEN:
          description: LPM support enable
          bitOffset: 0
          bitWidth: 1
          access: read-write
        LPMACK:
          description: LPM token acknowledge enable
          bitOffset: 1
          bitWidth: 1
          access: read-write
        BESL:
          description: Best effort service latency
          bitOffset: 2
          bitWidth: 4
          access: read-write
        REMWAKE:
          description: RemoteWake value
          bitOffset: 6
          bitWidth: 1
          access: read-write
        L1SSEN:
          description: L1 Shallow Sleep enable
          bitOffset: 7
          bitWidth: 1
          access: read-write
        BESLTHRS:
          description: BESL threshold
          bitOffset: 8
          bitWidth: 4
          access: read-write
        L1DSEN:
          description: L1 deep sleep enable
          bitOffset: 12
          bitWidth: 1
          access: read-write
        LPMRST:
          description: LPM response
          bitOffset: 13
          bitWidth: 2
          access: read-only
        SLPSTS:
          description: Port sleep status
          bitOffset: 15
          bitWidth: 1
          access: read-only
        L1RSMOK:
          description: Sleep State Resume OK
          bitOffset: 16
          bitWidth: 1
          access: read-only
        LPMCHIDX:
          description: LPM Channel Index
          bitOffset: 17
          bitWidth: 4
          access: read-write
        LPMRCNT:
          description: LPM retry count
          bitOffset: 21
          bitWidth: 3
          access: read-write
        SNDLPM:
          description: Send LPM transaction
          bitOffset: 24
          bitWidth: 1
          access: read-write
        LPMRCNTSTS:
          description: LPM retry count status
          bitOffset: 25
          bitWidth: 3
          access: read-only
        ENBESL:
          description: Enable best effort service latency
          bitOffset: 28
          bitWidth: 1
          access: read-write

  _modify:
    GRXSTSR_Host:
      alternateRegister: GRXSTSR_Device
    GNPTXSTS:
      name: HNPTXSTS
    CID:
      resetValue: 0x00002000

    GNPTXFSIZ_Device:
      name: DIEPTXF0
      displayName: DIEPTXF0

    GNPTXFSIZ_Host:
      name: HNPTXFSIZ
      displayName: HNPTXFSIZ
      alternateRegister: DIEPTXF0

OTG_FS_HOST:
  HCFG:
    _modify:
      FSLSS:
        access: read-write


OTG_FS_DEVICE:
  _copy:
    DIEPCTL4:
      _from: DIEPCTL1
      addressOffset: 0x180
      description: OTG device endpoint-4 control register
    DIEPCTL5:
      _from: DIEPCTL1
      addressOffset: 0x1A0
      description: OTG device endpoint-5 control register
    DIEPINT4:
      _from: DIEPINT1
      addressOffset: 0x188
      description: device endpoint-4 interrupt register
    DIEPINT5:
      _from: DIEPINT1
      addressOffset: 0x1A8
      description: device endpoint-5 interrupt register
    DTXFSTS4:
      _from: DTXFSTS1
      addressOffset: 0x198
    DTXFSTS5:
      _from: DTXFSTS1
      addressOffset: 0x1B8
    DIEPTSIZ4:
      _from: DIEPTSIZ1
      addressOffset: 0x190
    DIEPTSIZ5:
      _from: DIEPTSIZ1
      addressOffset: 0x1b0
    DOEPCTL4:
      _from: DOEPCTL1
      addressOffset: 0x380
    DOEPCTL5:
      _from: DOEPCTL1
      addressOffset: 0x3a0
    DOEPINT4:
      _from: DOEPINT1
      addressOffset: 0x388
    DOEPINT5:
      _from: DOEPINT1
      addressOffset: 0x3a8
    DOEPTSIZ4:
      _from: DOEPTSIZ1
      addressOffset: 0x390
    DOEPTSIZ5:
      _from: DOEPTSIZ1
      addressOffset: 0x3b0

  DIEPCTL0:
    _modify:
      EPENA:
        access: read-write

  DIEPCTL*:
    _modify:
      Stall:
        name: STALL
        description: STALL

  DOEPCTL*:
    _modify:
      Stall:
        name: STALL
        description: STALL

  DAINTMSK:
    _modify:
      OEPINT:
        name: OEPM
        description: OUT EP interrupt mask bits

  _include:
    - fs_v1_device_cluster.yaml
